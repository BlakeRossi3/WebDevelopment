(()=>{"use strict";var e,t,n,o,a,r,c,i=function(e,t,n,o){return void 0===o&&(o=1),"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(o,")")},l=Object.freeze({gain:.5,numSamples:256}),u=(new Uint8Array(l.numSamples/2),function(e){t.src=e}),s=function(){function e(e,t,n,o,a){void 0===o&&(o=50),void 0===a&&(a=50),this.x=e,this.y=t,this.width=o,this.height=a,this.image=new Image,this.image.src=n,this.pulseFactor=1}return e.prototype.update=function(e,t,n,o){var a=e[o]/255,r=.5*Math.sin(Date.now()/500)+1,c=.5*Math.sin(Date.now()/500)+1;this.pulseFactor=1+.5*a*(t*r+n*c)/2},e.prototype.draw=function(e){var t=this.width*this.pulseFactor,n=this.height*this.pulseFactor;e.drawImage(this.image,this.x-t/2,this.y-n/2,t,n)},e}();const d=s;var h,m,v,f,g,y=!1,w=new Image;w.src="media/space.jpg";var p=[];fetch("data/av-data.json").then((function(e){return e.json()})).then((function(e){e.stars.forEach((function(e){p.push(new d(e.x,e.y,"media/star.png",50,50))}))}));var b={showBars:!0,showCircles:!0,showNoise:!1,showInvert:!1,showEmboss:!1},q=Object.freeze({sound1:"media/New Adventure Theme.mp3"}),S=function(n){var o;fetch("data/av-data.json").then((function(e){return e.json()})).then((function(e){var t=document.querySelector("#instructions");t?e.instructions.forEach((function(e){var n=document.createElement("p");n.textContent=e,t.appendChild(n)})):console.error("Element with ID 'instructions' not found.")})).catch((function(e){console.error("Error loading JSON data:",e)}));var i=document.querySelector("#fs-button"),l=document.querySelector("#play-button");i.onclick=function(){var e;(e=n).requestFullscreen?e.requestFullscreen():e.mozRequestFullscreen?e.mozRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()},l.onclick=function(n){var o=n.target;"suspended"===e.state&&e.resume(),"no"===o.dataset.playing?(t.play(),o.dataset.playing="yes"):(t.pause(),o.dataset.playing="no")};var s=document.querySelector("#audio-form-button");s.onclick=function(){y=!y,s.innerHTML=y?"Waveform Mode":"Frequency Mode"},null===(o=document.getElementById("toggle-panel"))||void 0===o||o.addEventListener("click",(function(){var e=document.getElementById("left-panel");"none"===(null==e?void 0:e.style.display)||""===(null==e?void 0:e.style.display)?(e&&(e.style.display="block"),this.textContent="Hide Controls"):(e&&(e.style.display="none"),this.textContent="Show Controls")}));var d=document.querySelector("#volume-slider"),h=document.querySelector("#volume-label"),m=document.querySelector("#bass-slider"),v=document.querySelector("#treble-slider");d.oninput=function(e){var t,n=e.target;t=Number(n.value),a.gain.value=t,h.innerHTML=Math.round(Number(n.value)/2*100).toString();var o=.5+Number(n.value)/2*1.5;document.getElementById("mew-gif").playbackRate=o},m.oninput=function(e){var t=e.target,n=Number(t.value);r.gain.value=n},v.oninput=function(e){var t=e.target,n=Number(t.value);c.gain.value=n},d.dispatchEvent(new Event("input")),m.value="0",v.value="0";var f=document.querySelector("#file-input"),g=document.querySelector("#default-track-btn"),w=document.querySelector("#now-playing");f.onchange=function(e){var t,n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){var o=URL.createObjectURL(n);u(o),w.innerHTML="Now playing: "+n.name}},g.onclick=function(){u("media/New Adventure Theme.mp3"),w.innerHTML="Now playing: New Adventure Theme.mp3"},document.querySelector("#cb-bars").onclick=function(e){var t=e.target;b.showBars=t.checked},document.querySelector("#cb-circles").onclick=function(e){var t=e.target;b.showCircles=t.checked},document.querySelector("#cb-noise").onclick=function(e){var t=e.target;b.showNoise=t.checked},document.querySelector("#cb-invert").onclick=function(e){var t=e.target;b.showInvert=t.checked},document.querySelector("#cb-emboss").onclick=function(e){var t=e.target;b.showEmboss=t.checked}},k=function(){requestAnimationFrame(k),function(e){if(void 0===e&&(e={}),y?f.getByteTimeDomainData(g):f.getByteFrequencyData(g),h.save(),h.drawImage(w,0,0,m,v),h.restore(),e.showBars&&!y){var t=(m-4*g.length-10)/g.length,n=v/2;h.save(),h.fillStyle="rgba(74, 0, 110, 0.5)",h.strokeStyle="rgb(255, 255, 255)";for(var o=0;o<g.length;o++){var a=g[o],r=n-a/2,c=n+a/2;o%2==0?(h.fillRect(5+o*(t+4)+500,r,t,c-r),h.strokeRect(5+o*(t+4)+500,r,t,c-r)):(h.fillRect(500-(5+o*(t+4)),r,t,c-r),h.strokeRect(500-(5+o*(t+4)),r,t,c-r))}h.restore()}if(e.showCircles){var l=parseFloat(document.getElementById("bass-slider").value)/30+1,u=parseFloat(document.getElementById("treble-slider").value)/30+1,s=v/4;for(h.save(),h.globalAlpha=.5,o=0;o<g.length;o++){var d=g[o]/255,b=d*s,q=b*l,S=b*u;q*=.5*Math.sin(Date.now()/500)+1,S*=.5*Math.sin(Date.now()/500)+1,h.beginPath(),h.fillStyle=i(75,0,130,.34-d/3),h.arc(m-20,20,q,0,2*Math.PI,!1),h.fill(),h.closePath(),h.beginPath(),h.fillStyle=i(128,0,128,.5-d/5),h.arc(0,20,S,0,2*Math.PI,!1),h.fill(),h.closePath()}h.restore()}var k=Math.floor(Math.random()*g.length);p.forEach((function(e){e.update(g,1,1,k),e.draw(h)}));var F=h.getImageData(0,0,m,v),E=F.data,I=E.length,M=F.width;for(o=0;o<I;o+=4)if(e.showNoise&&Math.random()<.05&&(E[o]=E[o+1]=E[o+2]=0,E[o]=255),e.showInvert){var N=E[o],R=E[o+1],B=E[o+2];E[o]=255-N,E[o+1]=255-R,E[o+2]=255-B}if(e.showEmboss)for(o=0;o<I;o++)o%4!=3&&(E[o]=127+2*E[o]-E[o+4]-E[o+4*M]);h.putImageData(F,0,0)}(b)};window.onload=function(){console.log("window.onload called"),function(){var i,s;i=q.sound1,s=window.AudioContext||window.webkitAudioContext,e=new s,t=new Audio,u(i),n=e.createMediaElementSource(t),(o=e.createAnalyser()).fftSize=l.numSamples,(a=e.createGain()).gain.value=l.gain,(r=e.createBiquadFilter()).type="lowshelf",r.frequency.value=200,r.gain.value=0,(c=e.createBiquadFilter()).type="highshelf",c.frequency.value=3e3,c.gain.value=0,n.connect(r),r.connect(c),c.connect(o),o.connect(a),a.connect(e.destination);var d=document.querySelector("canvas");S(d),function(e,t){h=e.getContext("2d"),m=e.width,v=e.height,f=t,g=new Uint8Array(f.fftSize/2)}(d,o),k()}()}})();
//# sourceMappingURL=bundle.js.map