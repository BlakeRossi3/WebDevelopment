(()=>{"use strict";var e,t,n,o,r,a,c,l=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(o,")")},i=Object.freeze({gain:.5,numSamples:256});function u(e){t.src=e}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,d(o.key),o)}}function d(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}new Uint8Array(i.numSamples/2);var f=function(){return e=function e(t,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:50;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=n,this.width=r,this.height=a,this.image=new Image,this.image.src=o,this.pulseFactor=1},t=[{key:"update",value:function(e,t,n,o){var r=e[o]/255,a=.5*Math.sin(Date.now()/500)+1,c=.5*Math.sin(Date.now()/500)+1;this.pulseFactor=1+.5*r*(t*a+n*c)/2}},{key:"draw",value:function(e){var t=this.width*this.pulseFactor,n=this.height*this.pulseFactor;e.drawImage(this.image,this.x-t/2,this.y-n/2,t,n)}}],t&&h(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();const m=f;var v,g,y,p,b,w=!1,S=new Image;S.src="media/space.jpg";var q=[];fetch("data/av-data.json").then((function(e){return e.json()})).then((function(e){(q=e.stars).forEach((function(e){k.push(new m(e.x,e.y,"media/star.png",50,50))}))}));var k=q.map((function(e){return new m(e.x,e.y,"media/pokeball.png",50,50)})),M={showBars:!0,showCircles:!0,showNoise:!1,showInvert:!1,showEmboss:!1},P=Object.freeze({sound1:"media/New Adventure Theme.mp3"});function I(){requestAnimationFrame(I),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(w?p.getByteTimeDomainData(b):p.getByteFrequencyData(b),v.save(),v.drawImage(S,0,0,g,y),v.restore(),e.showBars)if(w){if(w){var t=(g-4*b.length-10)/b.length,n=y/2;v.save(),v.fillStyle="rgba(74, 0, 110, 0.5)",v.strokeStyle="rgb(255, 255, 255)";for(var o=0;o<b.length;o++){var r=Math.abs(b[o]-128),a=n-r/2,c=n+r/2;o%2==0?(v.fillRect(5+o*(t+4)+500,a,t,c-a),v.strokeRect(5+o*(t+4)+500,a,t,c-a)):(v.fillRect(500-(5+o*(t+4)),a,t,c-a),v.strokeRect(500-(5+o*(t+4)),a,t,c-a))}v.restore()}}else{var i=(g-4*b.length-10)/b.length,u=y/2;v.save(),v.fillStyle="rgba(74, 0, 110, 0.5)",v.strokeStyle="rgb(255, 255, 255)";for(var s=0;s<b.length;s++){var h=b[s],d=u-h/2,f=u+h/2;s%2==0?(v.fillRect(5+s*(i+4)+500,d,i,f-d),v.strokeRect(5+s*(i+4)+500,d,i,f-d)):(v.fillRect(500-(5+s*(i+4)),d,i,f-d),v.strokeRect(500-(5+s*(i+4)),d,i,f-d))}v.restore()}var m=document.getElementById("bassSlider").value,q=document.getElementById("trebleSlider").value,M=m/30+1,P=q/30+1;if(e.showCircles){var I=y/4;v.save(),v.globalAlpha=.5;for(var E=0;E<b.length;E++){var F=b[E]/255,R=F*I,B=R*M,C=R*P;B*=.5*Math.sin(Date.now()/500)+1,C*=.5*Math.sin(Date.now()/500)+1,v.beginPath(),v.fillStyle=l(75,0,130,.34-F/3),v.arc(g-20,20,B,0,2*Math.PI,!1),v.fill(),v.closePath(),v.beginPath(),v.fillStyle=l(0,0,0,.1-F/10),v.arc(g-20,20,1.5*B,0,2*Math.PI,!1),v.fill(),v.closePath(),v.beginPath(),v.fillStyle=l(128,0,128,.5-F/5),v.arc(g-20,20,.5*B,0,2*Math.PI,!1),v.fill(),v.closePath(),v.beginPath(),v.fillStyle=l(75,0,130,.34-F/3),v.arc(0,20,C,0,2*Math.PI,!1),v.fill(),v.closePath(),v.beginPath(),v.fillStyle=l(0,0,0,.1-F/10),v.arc(0,20,1.5*C,0,2*Math.PI,!1),v.fill(),v.closePath(),v.beginPath(),v.fillStyle=l(128,0,128,.5-F/5),v.arc(0,20,.5*C,0,2*Math.PI,!1),v.fill(),v.closePath()}v.restore()}var j=Math.floor(Math.random()*b.length);k.forEach((function(e){e.update(b,M,P,j),e.draw(v)}));for(var N=v.getImageData(0,0,g,y),x=N.data,A=x.length,D=N.width,T=0;T<A;T+=4)if(e.showNoise&&Math.random()<.05&&(x[T]=x[T+1]=x[T+2]=0,x[T]=255),e.showInvert){var z=x[T],L=x[T+1],O=x[T+2];x[T]=255-z,x[T+1]=255-L,x[T+2]=255-O}if(e.showEmboss)for(var H=0;H<A;H++)H%4!=3&&(x[H]=127+2*x[H]-x[H+4]-x[H+4*D]);v.putImageData(N,0,0)}(M)}window.onload=function(){console.log("window.onload called"),function(){var l,s;l=P.sound1,s=window.AudioContext||window.webkitAudioContext,e=new s,t=new Audio,u(l),n=e.createMediaElementSource(t),(o=e.createAnalyser()).fftSize=i.numSamples,(r=e.createGain()).gain.value=i.gain,(a=e.createBiquadFilter()).type="lowshelf",a.frequency.value=200,a.gain.value=0,(c=e.createBiquadFilter()).type="highshelf",c.frequency.value=3e3,c.gain.value=0,n.connect(a),a.connect(c),c.connect(o),o.connect(r),r.connect(e.destination);var h=document.querySelector("canvas");!function(n){fetch("data/av-data.json").then((function(e){return e.json()})).then((function(e){var t=document.querySelector("#instructions");t?e.instructions.forEach((function(e){var n=document.createElement("p");n.textContent=e,t.appendChild(n)})):console.error("Element with ID 'instructions' not found.")})).catch((function(e){console.error("Error loading JSON data:",e)})),document.querySelector("#fsButton").onclick=function(){var e;console.log("goFullscreen() called"),(e=n).requestFullscreen?e.requestFullscreen():e.mozRequestFullscreen?e.mozRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()},playButton.onclick=function(n){"suspended"==e.state&&e.resume(),console.log("audioCtx.state after = ".concat(e.state)),"no"==n.target.dataset.playing?(t.play(),n.target.dataset.playing="yes"):(t.pause(),n.target.dataset.playing="no")};var o=document.querySelector("#audioFormButton");o.onclick=function(){w=!w,o.innerHTML=w?"Waveform Mode":"Frequency Mode"},document.getElementById("toggle-panel").addEventListener("click",(function(){var e=document.getElementById("left-panel");"none"===e.style.display||""===e.style.display?(e.style.display="block",this.textContent="Hide Controls"):(e.style.display="none",this.textContent="Show Controls")}));var l=document.querySelector("#volumeSlider"),i=document.querySelector("#volumeLabel"),s=document.querySelector("#bassSlider"),h=document.querySelector("#trebleSlider");l.oninput=function(e){var t;t=e.target.value,t=Number(t),r.gain.value=t,i.innerHTML=Math.round(e.target.value/2*100);var n=.5+e.target.value/2*1.5;document.getElementById("mewgif").playbackRate=n},s.oninput=function(e){var t=Number(e.target.value);a.gain.value=t},h.oninput=function(e){var t=Number(e.target.value);c.gain.value=t},l.dispatchEvent(new Event("input")),s.value=0,h.value=0;var d=document.querySelector("#file-input"),f=document.querySelector("#default-track-btn"),m=document.querySelector("#now-playing");d.onchange=function(e){var t=e.target.files[0];t&&u(URL.createObjectURL(t)),m.innerHTML="Now playing:    "+t.name},f.onclick=function(){u("media/New Adventure Theme.mp3"),m.innerHTML="Now playing:    New Adventure Theme.mp3"},document.querySelector("#cb-bars"),document.querySelector("#cb-circles"),document.querySelector("#cb-noise"),document.querySelector("#cb-bars").onclick=function(e){M.showBars=e.target.checked},document.querySelector("#cb-circles").onclick=function(e){M.showCircles=e.target.checked},document.querySelector("#cb-noise").onclick=function(e){M.showNoise=e.target.checked},document.querySelector("#cb-invert").onclick=function(e){M.showInvert=e.target.checked},document.querySelector("#cb-emboss").onclick=function(e){M.showEmboss=e.target.checked}}(h),function(e,t){v=e.getContext("2d"),g=e.width,y=e.height,p=t,b=new Uint8Array(p.fftSize/2)}(h,o),I()}()}})();